<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Hexapode: Rapport - Manuel d&#39;utilisation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="IN7Robot.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Hexapode
   &#160;<span id="projectnumber">Version 1.0</span>
   </div>
   <div id="projectbrief">Thomas Waquet &amp; Gauthier Dhalluin</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Recherche');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Page&#160;principale</span></a></li>
      <li class="current"><a href="pages.html"><span>Pages&#160;associées</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Structures&#160;de&#160;données</span></a></li>
      <li><a href="files.html"><span>Fichiers</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Recherche" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_doc_1cdc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Tout</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Structures de données</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Fichiers</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Fonctions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Définitions de type</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Énumérations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Valeurs énumérées</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groupes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Rapport - Manuel d'utilisation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="../Rapport_Waquet-Dhalluin.html">Page d'accueil</a> </p>
<h1><a class="anchor" id="Sommaire"></a>
Sommaire</h1>
<p><a href="#Concept">Conception</a><br/>
</p>
<ul>
<li><a href="#Intro">1. Introduction</a><br/>
</li>
<li><a href="#Architecture">2. Architecture du projet</a><br/>
</li>
<li><a href="#GestFeet">3. La gestion des pattes</a><br/>
</li>
<li><a href="#GestHead">4. La gestion de la tête</a><br/>
</li>
<li><a href="#Capteur">5. Les capteurs</a><br/>
</li>
<li><a href="#Ordo">6. L'ordonnancement</a><br/>
</li>
<li><a href="#Comm">7. La communication</a><br/>
</li>
<li><a href="#IHM">8. L'Interface Homme-Machine</a><br/>
</li>
</ul>
<p><a href="#Doc">Documentation</a><br/>
</p>
<hr/>
 <h1><a class="anchor" id="Développement"></a>
Développement</h1>
<p><a class="anchor" id="Concept"></a> </p>
<h2><a class="anchor" id="Conception"></a>
Conception</h2>
<h3><a class="anchor" id="Intro"></a>1. Introduction</h3>
<p>Pour réaliser ce mini-projet, l'équipe de concepteur a tout d'abord analyser la demande du client, c'est à dire de concevoir un robot à <b>six pattes</b> pouvant être <b>autonome</b> et aussi diriger par un opérateur via une liaison sans fil, <b>Zigbee</b> (demande du client). De plus, ce robot sera muni d'une carte NXP pouvant accueillir un système temps réel, <b>FreeRTOS</b> (demande du client). Ce robot sera équipé aussi d'une caméra <b>CMUCAM2</b> (demande du client) qui aura pour rôle de guider le robot pour "tracker" une couleur. </p>
<p>Chaque patte est équipée de trois servo-moteurs permettant de réaliser les mouvements nécessaires pour faire marcher le robot. Un télémètre sera installé sur le devant du robot. Il aura pour but de faire éviter un obstacle au robot lorsqu'il sera en train de se déplacer. </p>
<p>Nous avons établi un ordre dans la conception du programme :</p>
<ol type="1">
<li>Création d'une PWM</li>
<li>Création de toute les PWM</li>
<li>Création d'un module pour l'UART</li>
<li>Gestion des PWM via l'UART (création de protocoles)</li>
<li>Mise en place des capteurs TOR</li>
<li>Utilisation et mise en place du télémètre</li>
<li>Mise en place de la CMUCAM2 (choix des modes, mise en place du protocole de la caméra)</li>
<li>Création d'une IHM permettant de visualiser la flux vidéo et la gestion du robot.</li>
<li>Mise en place d'algorithmes de marches</li>
<li>Mise en place d'un suivi d'objet </li>
</ol>
<h3><a class="anchor" id="Architecture"></a>2. Architecture du projet</h3>
<p>Dans une idée de développer du bas vers le haut, nous avons donc utilisé plusieurs structures afin d'organiser notre code. Chaque éléments du robot est représenté par une structure. Nous nous sommes inspirés des développements réalisés en langage objet. De cette manière, il est plus facile de ce repérer. De plus, chaque éléments (telementre,cmucam, servo-moteurs, ...) "possède" un fichier .c et un fichier .h où sont déclarés les structures. Voici un schéma qui permet de représenter le système : </p>
<div class="image">
<img src="..\img\archi.png"  alt="archi" title="Architecture du projet"/>
</div>
<p>Ensuite, l'équipe d'<em>Insset Robotics</em> chargée de la conception logicielle de ce projet est parti dans le principe de découper le robot en deux grandes parties: </p>
<ul>
<li>La tête<ul>
<li>La caméra CMUCAM2</li>
<li>Le télémètre</li>
<li>Le servo-moteur Axe X</li>
<li>Le servo-moteur Axe Y</li>
</ul>
</li>
<li>Les pattes<ul>
<li>Patte Avant Gauche (Feet Left Font)</li>
<li>Patte Avant Droite (Feet Right Font)</li>
<li>Patte Milieu Gauche (Feet Left Middle)</li>
<li>Patte Milieu Droite (Feet Right Middle)</li>
<li>Patte Arrière Gauche (Feet Left Back)</li>
<li>Patte Arrière Droite (Feet Right Back)</li>
</ul>
</li>
</ul>
<p>Dont chaque patte est inspirée sur ce modèle suivant :</p>
<ul>
<li>Patte X<ul>
<li>Le servo-moteur Axe X</li>
<li>Le servo-moteur Axe Y</li>
<li>Le servo-moteur Axe Z</li>
<li>Le capteur Tout-Ou-Rien</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="GestFeet"></a>3. La gestion des pattes</h3>
<h4>3.1 La reflexion</h4>
<p>L'équipe d'<em>Insset Robotics</em> a décidé d'utiliser deux timers hardware pour gérer les 20 <b>PWM</b> (Pulse Width Modulation) des 20 servo- moteurs, dont 2 sont intégrés dans la tête du robot permettant de faire pivoter la tête chercheuse sur deux axes différents. Un Timer sera utilisé pour gérer les toutes les PWM dans la même période de timer, donc dans une période de 20ms. L'autre timer permet quant à lui de mettre la sortie à l'état haut le temps voulu ( <em>t</em> compris entre 1 et 2ms - <em>cf. Onglet Servo-moteurs</em>). </p>
<h4>3.2 Le protocole</h4>
<p>Dans le cahier des charges, il est stipulé que les pattes doivent être diriger dans un premier temps manuellement par l'intermédiaire d'une liaison série entre un ordinateur et le robot. Pour ce faire, l'équipe d'<em>Insset Robotics</em> a conçu un protocole de communication permettant de changer la valeur de l'angle des servo-moteurs via une commande dans un terminal. Voici un exemple de trame pouvant être envoyer au robot via le terminal. </p>
<div class="fragment"><div class="line">$F,L,F,1,18\n</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>$</b> correspond au début de la trame</p>
<p><b>L</b> correspond au coté du robot. Peut prendre comme valeur <b>L</b> pour <em>Left</em> ou <b>R</b> pour <em>Right</em></p>
<p><b>F</b> correspond à la position de la patte. Peut prendre comme valeur <b>F</b> pour <em>Font</em> ou <b>M</b> pour <em>Middle</em> ou <b>B</b> pour <em>Back</em></p>
<p><b>1</b> correspond au numéro du servo-moteur de la patte. Peut prendre comme valeur <b>1</b>,<b>2</b> ou <b>3</b></p>
<p><b>18</b> correspond à l'angle en degrès. Peut prendre comme valeur un chiffre compris en chiffre compris entre 0 et 180. (* <em>uniquement des multiples de 9</em>)</p>
<p></p>
</blockquote>
<p><b>* Informations :</b> Nous avons décidé que le pas en degrés serait 9° par soucis de compatibilité avec notre configuration (seulement 2 timers utilisés)</p>
<div class="fragment"><div class="line">$TOR,L,F,5\n</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>$</b> correspond au début de la trame</p>
<p><b>TOR</b> correspond aux trames des capteurs TOR</p>
<p><b>L</b> correspond au coté du robot. Les valeurs comprises sont L ou R pour <em>Left</em> ou <em>Right</em></p>
<p><b>F</b> correspond à l'emplacement de la pate. Les valeurs comprises sont F, M ou B pour <em>Font</em>, <em>Middle</em> ou <em>Back</em></p>
<p><b>5</b> correspond à la valeur du Time Out en seconde.</p>
<p></p>
</blockquote>
<h4>3.3 Programmation</h4>
<p>Comme nous l'avons expliqué ci-dessus, chaque élément est représenté par une structure de données. Les 6 pattes qui composent le robot sont représentées par cette structure :</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct_servo_moteur.html">ServoMoteur</a> xServo1;</div>
<div class="line">    <a class="code" href="struct_servo_moteur.html">ServoMoteur</a> xServo2;</div>
<div class="line">    <a class="code" href="struct_servo_moteur.html">ServoMoteur</a> xServo3;</div>
<div class="line">    <a class="code" href="struct_tor.html">Tor</a> xTor1;</div>
<div class="line"></div>
<div class="line">}<a class="code" href="struct_feet_hexapode.html">FeetHexapode</a>;</div>
</div><!-- fragment --><p>Dans cette structure une patte est représentée par 3 servo-moteurs, ici avec la structure <em><a class="el" href="struct_servo_moteur.html">ServoMoteur</a></em>. De plus, chaque patte est composée d'un capteur Tout-Ou-Rien permettant de savoir si la patte est en liaison avec le sol, d'où la variable de type <a class="el" href="struct_tor.html">Tor</a> qui est une structure représentant un capteur TOR. Voici, les deux structures évoquées ci-dessus : </p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ucTorValue;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ucTorNum;</div>
<div class="line"></div>
<div class="line">}<a class="code" href="struct_tor.html">Tor</a>;</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>ucTorValue</b> correspond à la valeur du capteur (1 ou 0)</p>
<p><b>ucTorNum</b> correspond au masque du capteur (0x02, 0x04, 0x08, 0x10, 0x20)</p>
<p></p>
</blockquote>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ucAngle;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ucCount;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ucPwmNum;</div>
<div class="line"></div>
<div class="line">}<a class="code" href="struct_servo_moteur.html">ServoMoteur</a>;</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>ucAngle</b> correspond à la valeur de l'angle du servo-moteur</p>
<p><b>ucCount</b> correspond au compteur de pas</p>
<p><b>ucPwmNum</b> correspond au numéro de la PWM qui correspond au un servo-moteur (de 0 à 19)</p>
<p></p>
</blockquote>
<h3><a class="anchor" id="GestHead"></a>4. La gestion de la tête</h3>
<h4>4.1 Réflexion</h4>
<p>Dans le même esprit que pour les pattes, nous avons décidé de représenter la tête du robot sous forme d'une structure. La tête du robot est composé deux servo-moteurs permettant de la faire pivoter et bouger de droite à gauche et de haut en bas. Ensuite, nous avons décidé d'intégrer dans la structure le télémètre IR de Sharp (<em>cf. Onglet Télémètre</em>). Pour la gestion des PWM des 2 servo-moteurs, elles sont gérées comme pour les pattes, par 2 timers hardware. La tête du robot est équipé d'une caméra de vision CMUCAM2 permettant d'avoir un flux vidéo pour diriger le robot à distance ou de traquer une couleur par exemple (<em>cf. Onglet Caméra</em>) </p>
<h4>4.2 Le protocole</h4>
<p>Dans le but de vérifier le bon fonctionnement de notre programme, nous testons via l'UART en simulant la valeur du télémètre par exemple. Pour cela, nous faisions exactement pour la gestion des pattes par l'intermédiaire de trames.</p>
<div class="fragment"><div class="line">$TELE,x,10\n</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>$</b> correspond au début de la trame</p>
<p><b>TELE</b> correspond aux trame des Telemètres. Dans notre cas, il n'y a qu'un mais nous avons penser à en rajouter pour l'évolution du produit</p>
<p><b>X</b> correspond au numéro du télémètre. Ici, 0 par défaut</p>
<p><b>10</b> correspond à la distance de sécurité à ne pas dépasser pour pouvoir éviter l'objet.</p>
<p></p>
</blockquote>
<div class="fragment"><div class="line">$CAM,MODE,R,G,B\n</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>$</b> correspond au début de la trame</p>
<p><b>CAM</b> correspond à une trame de configuration pour la caméra</p>
<p><b>MODE</b> correspond aux modes de la caméra</p>
<p><b>R,G,B</b> correspond aux valeurs des 3 couleurs qui compose la couleur souhaité (uniquement pour le mode de "Color Tracking")</p>
<p></p>
</blockquote>
<h4>4.3 Programmation</h4>
<p>Pour la gestion de la tête du robot, nous avons penser à une structure contenant les deux servo-moteurs ainsi que le télémètre. Pour des raisons de temps, nous n'avons pas encore intégrer les variables pour la caméra. Mais nous avons déjà penser à la manière dont nous allons l'intégrer. Plusieurs variables seront utiles selon l'utilisation de la caméra, mode tracking par exemple.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct_servo_moteur.html">ServoMoteur</a> xServo1;</div>
<div class="line">    <a class="code" href="struct_servo_moteur.html">ServoMoteur</a> xServo2;</div>
<div class="line">    <a class="code" href="struct_telemetre.html">Telemetre</a> xTelemetre1;</div>
<div class="line"></div>
<div class="line">}<a class="code" href="struct_head_hexapode.html">HeadHexapode</a>;</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>xServo1</b> correspond au servo-moteur de l'axe X</p>
<p><b>xServo2</b> correspond au servo-moteur de l'axe Y</p>
<p><b>xTelemetre1</b> correspond au télémètre numéro 1.</p>
<p></p>
</blockquote>
<p>Avec les modifications pour l'ajout de la caméra, voici à quoi pourrait ressembler la structure de la tête :</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct_servo_moteur.html">ServoMoteur</a> xServo1;</div>
<div class="line">    <a class="code" href="struct_servo_moteur.html">ServoMoteur</a> xServo2;</div>
<div class="line">    <a class="code" href="struct_telemetre.html">Telemetre</a> xTelemetre1;</div>
<div class="line">    Color xColorTrack; <span class="comment">//</span></div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ucMode;</div>
<div class="line">    Flux xFluxCMUCAM;</div>
<div class="line"></div>
<div class="line">}<a class="code" href="struct_head_hexapode.html">HeadHexapode</a>;</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>xColorTrack</b> correspond aux valeurs des couleurs (Rouge, Vert et Bleu) de l'objet à "tracker"</p>
<p><b>ucMode</b> correspond au mode que nous voulons pour la caméra (<em>cf. Onglet Caméra</em>)</p>
<p><b>xFluxCMUCAM</b> correspond au flux vidéo de la caméra.</p>
<p></p>
</blockquote>
<p>La structure <b>Color</b> permettrait de mettre les valeurs, de 0 à 255, des couleurs composant la couleur à suivre. </p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Red;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Green;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Blue;</div>
<div class="line"></div>
<div class="line">}Color;</div>
</div><!-- fragment --><h3><a class="anchor" id="Capteur"></a>5. Les capteurs</h3>
<p>Plusieurs capteurs équipent le robot :</p>
<ul>
<li>Les capteurs TOR</li>
<li>Le (ou les) télémètre(s) IR Sharp GP2D12</li>
</ul>
<h4>5.1 Capteurs TOR</h4>
<p>Pour l'utilisation de ces capteurs peut de choses sont à mettre en place. Il suffit de lire l'état présent sur la broche qui est reliée à capteur TOR pour avoir l'information : </p>
<ul>
<li>Si la patte est en contact avec le sol, la valeur présente sur la broche vaut 1 (état logique haut).</li>
<li>Si la patte n'est pas en contact avec le sol, la valeur présente sur la broche vaut alors 0 (état logique bas).</li>
</ul>
<p>Dans le second cas, après un certains temps ("Le Time Out" - <em>cf. 3.2 Protocole &amp; Onglet Capteur TOR</em>) nous estimons qu'il y a présence d'une erreur. </p>
<h4>5.2 Télémètre IR Sharp GP2D12</h4>
<p>Pour l'utiliser un tel capteur, il est nécessaire de mettre en place un convertisseur Analogique-Numérique (ADC). La valeur retournée par le télémètre est une valeur analogique comprise entre 0,6V et 3,1V correspondant respectivement à 80cm et à 10cm. Le principe de fonctionnement est expliqué dans l'onglet <em>Le télémètre</em>. D'après la documentation du constructeur, qui est aussi disponible dans l'ongler <em>Le télémètre</em>, la courbe représentative du capteur est celle d'un système non-linéraire ce qui rend la convertion plus difficile. Cela est du au phénomène du cône qui est formé par le faisceau InfraRouge. Dans ce cas nous avons simplifier par mesure de simplicité et de temps et aussi par le manque du télémètre, linéariser le système. Le risque d'une telle manipulation est de changer la précision, qui d'après nous serait au millimètre. Dans notre cas, la précision au millimètre près n'est pas forcément utile car il est important d'esquiver un obstable bien avant d'arriver sur lui. </p>
<h3><a class="anchor" id="Ordo"></a>6. L'ordonnancement</h3>
<p>Le corps de ce projet est que le robot ne fonctionne pas sur un simple microcontrolleur. Nous utilisons un microcontrolleur ARM Cortex M3 de chez NXP avec un système temps réel. Qui dit temps réel insinue le temps exact que prends une tâche ainsi qu'une notion d'ordonnancement de tâches diverses. La difficulté d'un système dit temps réel est le nombre de tâche à executer. Plus le nombre est grand plus la difficulté à ordonnancer est grande. C'est pour cela que l'équipe d'<em>Insset Robotics</em> a essayer de minimiser ce nombre de tâches tout en remplissant les demandes du client. Dans la configuration sans la caméra, nous n'avons que 3 tâches : </p>
<ol type="1">
<li>Tâche 1 : Lecture des différents capteurs (télémètre [<b>ADC</b>], TOR)</li>
<li>Tâche 2 : Gestion des PWM</li>
<li>Tâche 3 : Gestion des files de messages de la communication et le décodage des trames</li>
</ol>
<p>Pour ordonnancer et définir les tâches prioritaires nous avons donc utiliser la méthode RM (<b>Rate Monotonic</b>) qui consiste a attribuer la priorité la plus forte à la tâche qui possède la plus petite période. La tâche la plus prioritaire de notre système est la tâche 2 ensuite la tâche 1 et la tâche la moins prioritaire est la tâche 3. Les priorités sont figées et ne varient pas dans le temps ce qui serait incompatible avec la méthode d'ordonnancement choisie. </p>
<h3><a class="anchor" id="Comm"></a>7. La communication</h3>
<p>La communication qui a été choisi par le client afin de communiquer avec le robot depuis un ordinateur sous un OS de son choix est une solution sans fil, le Zigbee. Le Zigbee est un protocole haut niveau de communication sans fil à très basse consommation. Ce facteur a tout son importance pour un système qui doit être indépendant. Pour la mise en place d'un tel réseau sans fil, nous avons besoin d'initialiser un port de communication à l'aide de l'UART qui est un des périphériques présents de la carte NXP LCP1761. </p>
<h4>7.1 L'émission</h4>
<p>Pour l'émission des messages vers le PC qui commande le robot, l'équipe de développeur a décidé de mettre en place une pile FIFO (First In First Out) qui permettra de stocker les messages à envoyer et se videra au fûr et à mesure que l'ordonnanceur donne la main à la tâche s'occupant de l'envoi. </p>
<h4>7.2 La reception</h4>
<p>Pour la réception des messages provenant du PC qui commande le robot, nous avons choisi de mettre également une queue de message de type FIFO (First In First Out) qui stockera les message reçus et videra cette pile quand le message aura été décripté et traité. </p>
<h4>7.3 Schématisation</h4>
<p>Voici à quoi ressemble le principe des files de messages que nous allons mettre en place au sein du projet. </p>
<div class="image">
<img src="../img/queue.png"  alt="queue" title="Files de messages"/>
</div>
<h3><a class="anchor" id="IHM"></a>8. L'Interface Homme-Machine</h3>
<p>Afin de garantir un confort d'utilisation, une IHM (<em>Interface Homme-Machine</em>) doit être réalisé. Cette IHM permettra à l'utilisateur de configurer le robot, le choix du mode (Autonome ou Manuel), les choix pour la caméra (exemple : <em>tracking</em> de couleur) mais aussi de diriger le robot à l'aide de flèches permettant de faire avancer, reculer, se diriger vers la gauche ou la droite. Sur cette IHM, nous pourrons aussi trouver, par exemple la présence ou non d'un obstable et de la distance qui sépare la tête du robot à ce dernier. Lorsque le développement de la caméra sera achevé, l'interface donnera la possibilité de voir le flux vidéo de la caméra qui sera une aide pour se déplacer avec le robot. Lorsque les algorithmes de marches seront réalisés ainsi que testés, il sera possible à l'utilisateur de saisir le type de marche voulu, en crabe, 3 pattes par 3 pattes (en triangle), ...</p>
<p>Voici à quoi pourrait ressembler l'interface graphique :</p>
<div class="image">
<img src="../img/IHM.png"  alt="IHM" title="Interface graphique du logiciel HexaControl"/>
</div>
<p> <a class="anchor" id="#Doc"></a> </p>
<h1><a class="anchor" id="Documentation"></a>
Documentation</h1>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Généré le Mardi Janvier 7 2014 11:23:06 pour Hexapode par
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
